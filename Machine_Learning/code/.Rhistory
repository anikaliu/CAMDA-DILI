if (!require("BiocManager"))
install.packages("BiocManager")
BiocManager::install("maEndToEnd")
library("Biobase")
mydata<-read.csv("CompletelyRandomPeople.csv")
mydata<-read.csv("/Users/psrw2/OneDrive - University Of Cambridge/Statistics_4_Chemists/DA2 - Basic Data Analysis-20190114/CompletelyRandomPeople.csv")
mydata<-read.csv("CompletelyRandomPeople.csv")
mydata<-read.csv("/Users/psrw2/OneDrive - University Of Cambridge/Statistics_4_Chemists/DA2 - Basic Data Analysis-20190114/CompletelyRandomPeople.csv")
head(mydata)
names(mydata)
colnames(mydata)
rownames(mydata)
nrow(mydata)
ncol(mydata)
attributes(mydata)
summary(mydata)
chickwts <- read.csv("/Users/psrw2/OneDrive - University Of Cambridge/Statistics_4_Chemists/DA2-ChickenData.csv")
chickwts <- read.csv("/Users/psrw2/OneDrive - University Of Cambridge/Statistics_4_Chemists/DA2 - Basic Data Analysis-20190114/DA2-ChickenData.csv")
head(chickwts)
summary(chickwts)
?hist
weight<-chickwts$weight
hist(weight)
hist(weight, breaks=20)
hist(weight, breaks=c(100,175,200,250,300,325,450))
hist(weight, breaks=20, main=”My first histogram”,
xlab=”abscissa”, ylab=”ordinate”)
hist(weight, breaks=20, main=”My first histogram”,xlab=”abscissa”, ylab=”ordinate”)
hist(weight, breaks=20, main=”My first histogram”, xlab=”abscissa”, ylab=”ordinate”)
hist(weight, breaks=20, main='My first histogram', xlab=”abscissa”, ylab=”ordinate”)
hist(weight, breaks=20, main='My first histogram', xlab='abscissa', ylab='ordinate')
hist(weight, breaks=20, main='My first histogram', xlab='weight', ylab='frequency')
hist(weight, breaks=c(100,250,350,450), main='My first histogram', xlab='weight', ylab='frequency')
hist(weight, breaks=c(100,250,300,350,450), main='My first histogram', xlab='weight', ylab='frequency')
boxplot(weight)
boxplot(weight, main = 'Chicken Weights Boxplot')
halfweights<-weight/2
doubleweight<-weight*2
boxplot(weight,halfweight,doubleweight)
boxplot(weight,halfweights,doubleweight)
boxplot(weight,halfweights,doubleweight,names = (standard,half,double))
boxplot(weight,halfweights,doubleweight, names = c(standard,half,double))
boxplot(weight,halfweights,doubleweight, names = c('standard','half','double'))
boxplot(chickwts)
boxplot(weight~feed,data=chickwts)
head(swiss)
agriculture<-swiss$Agriculture
education<-swiss$Education
plot(education,agriculture)
plot(Agriculture~Education,data=swiss)
?plot
plot(Agriculture~Education,data=swiss, main=“Swiss Data”,xlab= “Proportion Educated Beyond Primary'', ylab='Proportion working in Agriculture', pch=19, col='blue', cex=0.75, type='b')
plot(Agriculture~Education,data=swiss, main='Swiss Data',xlab= 'Proportion Educated Beyond Primary', ylab='Proportion working in Agriculture', pch=19, col='blue', cex=0.75, type='b')
swiss[order(swiss$Agriculture),]
plot(Agriculture~Education,data=swiss, main='Swiss Data',xlab= 'Proportion Educated Beyond Primary', ylab='Proportion working in Agriculture', pch=19, col='blue', cex=0.75, type='b')
swiss<-swiss[order(swiss$Agriculture),]
plot(Agriculture~Education,data=swiss, main='Swiss Data',xlab= 'Proportion Educated Beyond Primary', ylab='Proportion working in Agriculture', pch=19, col='blue', cex=0.75, type='b')
View(swiss)
head(swiss)
plot(Agriculture~Education,data=swiss[order(swiss$Education),], main='Swiss Data',xlab= 'Proportion Educated Beyond Primary', ylab='Proportion working in Agriculture', pch=19, col='blue', cex=0.75, type='b')
mean(swiss$Agriculture)
mean(swiss)
var(swiss$Agriculture)
quantile(swiss$Agriculture)
range(swiss$Agriculture)
range(chickwts$weights)
range(chickwts$weight)
apply(swiss,2,quantile)
aggregate(weight~feed,data=chickwts,sd)
aggregate(weight~feed,data=chickwts,mean)
mydata<-read.csv("CompletelyRandomPeople.csv")
mydata<-read.csv("/Users/psrw2/OneDrive - University Of Cambridge/Statistics_4_Chemists/DA2 - Basic Data Analysis-20190114/DA2-ChickenData.csv")
boxplot(weight~feed,data=mydata)
hist(mydata$weight)
hist(mydata$weight, main='Chicken weight vs. Frequency',xlab='weight'
,ylab='Frequency')
print(mean(mydata$weight))
print(aggregate(weight~feed),data=mydata,mean)
head(mydata)
print(aggregate(weight~feed),data=mydata,mean)
print(aggregate(weight~feed,data=mydata,mean))
print(aggregate(call~stimulus,data=mydata,var))
head(mydata)
#
boxplot(interval~stimulus,data=mydata)
head(mydata)
rm(list=ls())
head(mydata)
#head(mydata)
#boxplot(interval~stimulus,data=mydata)
#plot(mydata$duration,mydata$call)
#hist(mydata$call, main='Mating Calls vs. Frequency',xlab='weight'
,ylab='Frequency')
mydata<-read.csv("/Users/psrw2/OneDrive - University Of Cambridge/Statistics_4_Chemists/DA2 - Basic Data Analysis-20190114/DA2-ChickenData.csv")
rm(mydata)
mydata<-read.csv("/Users/psrw2/OneDrive - University Of Cambridge/Statistics_4_Chemists/DA2 - Basic Data Analysis-20190114/Frog_Data.csv")
head(mydata)
boxplot(interval~stimulus,data=mydata)
plot(mydata$duration,mydata$call)
plot(mydata$duration,mydata$call, ylab='Freq Calls',xlab='Call Duration')
hist(mydata$call, main='Mating Calls vs. Frequency',xlab='Call'
,ylab='Frequency')
#head(mydata)
print(aggregate(call~stimulus,data=mydata,var))
print(mean(mydata$interval),mean(mydata$duration),mean(mydata$call))
print(mean(mydata$interval))
print(mean(mydata$call))
dotchart(mydata$duration)
pie(mydata$duration)
stripchart(mydata$duration)
barplot(mydata$duration)
boxplot(mydata$duration,mydata$call)
boxplot(mydata)
source("https://bioconductor.org/biocLite.R")
biocLite("simpleaffy")
library(simpleaffy)
.libPaths()
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("simpleaffy", version = "3.8")
install.packages()
install.packages("affy")
install.packages("BoicLite")
BiocManager::install("affy")
BiocManager::install(c("GenomicFeatures", "AnnotationDbi"))
BiocManager::install("XML")
paste0(R.home(), "/library")
R.home()
.libPaths(paste0(R.home(), "/library"))
.libPaths()
BiocManager::install("XML")
.libPaths()
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("xps", version = "3.8")
library(xps)
if (!requireNamespace("BiocManager", quietly = TRUE))
+     install.packages("BiocManager")
> BiocManager::install("xps", version = "3.8")
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("xps", version = "3.8")
library(xps)
library(affy)
library("xps")
install.packages(c("matrixStats", "Hmisc", "splines", "foreach", "doParallel", "fastcluster", "dynamicTreeCut", "survival")
source("http://bioconductor.org/biocLite.R")
biocLite(c("GO.db", "preprocessCore", "impute"))
if (!requireNamespace("BiocManager"))
install.packages("BiocManager")
BiocManager::install()
setwd("~/OneDrive - University Of Cambridge/CasualR_Toxicogenomics/Renal_Toxicity")
load("/Users/psrw2/OneDrive - University Of Cambridge/CAMBA_Competition/Abdu_Plotting_Scripts_20_12_19/figures_script.RData")
Abdu <- load("/Users/psrw2/OneDrive - University Of Cambridge/CAMBA_Competition/Abdu_Plotting_Scripts_20_12_19/figures_script.RData")
####Load librariers####
library(tidyverse)
library(ggplot2)
####Aggregate individual performance files####
cv_ECFP<-read.csv('../data/Model_Results_Parameters/ECFP/cv_scores_ECFP.csv')%>%
separate(splits, sep='\\.',
into=c('dataset', 'method', 'true_or_y_scrambled_labels_used','train_test_split','cv_split'))%>%
mutate('testset'='LOCO-CV', 'descriptor'='ECFP')
ts_ECFP<-read.csv('../data/Model_Results_Parameters/ECFP/test_scores_ECFP.csv')%>%
separate(splits, sep='\\.',
into=c('dataset', 'method', 'true_or_y_scrambled_labels_used','train_test_split','cv_split'))%>%
mutate('testset'='External Test Set', 'descriptor'='ECFP')
setwd("~/OneDrive - University Of Cambridge/GitHub/CAMDA-DILI/Machine_Learning/code")
####Load librariers####
library(tidyverse)
library(ggplot2)
####Aggregate individual performance files####
cv_ECFP<-read.csv('../data/Model_Results_Parameters/ECFP/cv_scores_ECFP.csv')%>%
separate(splits, sep='\\.',
into=c('dataset', 'method', 'true_or_y_scrambled_labels_used','train_test_split','cv_split'))%>%
mutate('testset'='LOCO-CV', 'descriptor'='ECFP')
ts_ECFP<-read.csv('../data/Model_Results_Parameters/ECFP/test_scores_ECFP.csv')%>%
separate(splits, sep='\\.',
into=c('dataset', 'method', 'true_or_y_scrambled_labels_used','train_test_split','cv_split'))%>%
mutate('testset'='External Test Set', 'descriptor'='ECFP')
ex_ECFP<-read.csv('../data/FDA_Validation_Set_Results/Predictions_ECFP4/ambiguous_results.csv')%>%
separate(splits, sep='\\.',
into=c('dataset', 'method', 'true_or_y_scrambled_labels_used','train_test_split','cv_split'))%>%
mutate('testset'='FDA Validation Set', 'descriptor'='ECFP')
cv_MD<-read.csv('../data/Model_Results_Parameters/MD_newscaling/cv_scores_MD.csv')%>%
separate(splits, sep='\\.',
into=c('dataset', 'method', 'true_or_y_scrambled_labels_used','train_test_split','cv_split'))%>%
mutate('testset'='LOCO-CV', 'descriptor'='MD')
####Load librariers####
library(tidyverse)
library(ggplot2)
####Aggregate individual performance files####
cv_ECFP<-read.csv('../data/Model_Results_Parameters/ECFP/cv_scores_ECFP.csv')%>%
separate(splits, sep='\\.',
into=c('dataset', 'method', 'true_or_y_scrambled_labels_used','train_test_split','cv_split'))%>%
mutate('testset'='LOCO-CV', 'descriptor'='ECFP')
ts_ECFP<-read.csv('../data/Model_Results_Parameters/ECFP/test_scores_ECFP.csv')%>%
separate(splits, sep='\\.',
into=c('dataset', 'method', 'true_or_y_scrambled_labels_used','train_test_split','cv_split'))%>%
mutate('testset'='External Test Set', 'descriptor'='ECFP')
ex_ECFP<-read.csv('../data/FDA_Validation_Set_Results/Predictions_ECFP4/ambiguous_results.csv')%>%
separate(splits, sep='\\.',
into=c('dataset', 'method', 'true_or_y_scrambled_labels_used','train_test_split','cv_split'))%>%
mutate('testset'='FDA Validation Set', 'descriptor'='ECFP')
cv_MD<-read.csv('../data/Model_Results_Parameters/MD_newscaling/cv_scores_MD_newscaling.csv')%>%
separate(splits, sep='\\.',
into=c('dataset', 'method', 'true_or_y_scrambled_labels_used','train_test_split','cv_split'))%>%
mutate('testset'='LOCO-CV', 'descriptor'='MD')
ts_MD<-read.csv('../data/Model_Results_Parameters/MD_newscaling/test_scores_MD_newscaling.csv')%>%
separate(splits, sep='\\.',
into=c('dataset', 'method', 'true_or_y_scrambled_labels_used','train_test_split','cv_split'))%>%
mutate('testset'='External Test Set', 'descriptor'='MD')
ex_MD<-read.csv('../data/FDA_Validation_Set_Results/Predictions_MD_newscaling/ambiguous_results.csv')%>%
separate(splits, sep='\\.',
into=c('dataset', 'method', 'true_or_y_scrambled_labels_used','train_test_split','cv_split'))%>%
mutate('testset'='FDA Validation Set', 'descriptor'='MD')
cv_PT<-read.csv('../data/Model_Results_Parameters/PT/cv_scores_PT.csv')%>%
separate(splits, sep='\\.',
into=c('dataset', 'method', 'true_or_y_scrambled_labels_used','train_test_split','cv_split'))%>%
mutate('testset'='LOCO-CV', 'descriptor'='PT')
ts_PT<-read.csv('../data/Model_Results_Parameters/PT/test_scores_PT.csv')%>%
separate(splits, sep='\\.',
into=c('dataset', 'method', 'true_or_y_scrambled_labels_used','train_test_split','cv_split'))%>%
mutate('testset'='External Test Set', 'descriptor'='PT')
ex_PT<-read.csv('../data/FDA_Validation_Set_Results/Predictions_PT/ambiguous_results.csv')%>%
separate(splits, sep='\\.',
into=c('dataset', 'method', 'true_or_y_scrambled_labels_used','train_test_split','cv_split'))%>%
mutate('testset'='FDA Validation Set', 'descriptor'='PT')
df_performance<-cv_ECFP%>%
bind_rows(ts_ECFP)%>%
bind_rows(cv_MD)%>%
bind_rows(ts_MD)%>%
bind_rows(cv_PT)%>%
bind_rows(ts_PT)%>%
bind_rows(ex_ECFP)%>%
bind_rows(ex_MD)%>%
bind_rows(ex_PT)
df_performance<- df_performance%>%select(dataset, method, descriptor, testset, everything())
df_performance$dataset_readable=NA
df_performance$dataset_readable[which(df_performance$dataset=='all')]<-'DILIrank \n (+SIDER)'
df_performance$dataset_readable[which(df_performance$dataset=='MCLCNC')]<-'DILIrank'
df_performance$dataset_readable[which(df_performance$dataset=='MCNC')]<-'DILIrank \n (-vLessConcern)'
write.csv(df_performance,'../data/Model_Results_Parameters/summarized_performance.csv', row.names = F)
####Generate figure####
#Convert to factors and assing orders
df_performance$dataset_readable<-factor(df_performance$dataset_readable, levels=c('DILIrank \n (-vLessConcern)','DILIrank','DILIrank \n (+SIDER)'))
df_performance$testset<-factor(df_performance$testset, levels=c('LOCO-CV','External Test Set','FDA Validation Set'))
#true_or_y_scrambled_labels_used =1 means standard model, everything else is scrambled
df_models<-df_performance%>%
filter(true_or_y_scrambled_labels_used ==1)
df_scrambledmedians<-df_performance%>%
filter(true_or_y_scrambled_labels_used !=1)%>%
group_by(dataset_readable, method, testset,descriptor)%>%summarise("median_balacc"=median(balanced_accuracy))%>%mutate('scrambled'="Scrambled performance")
df_standardmeans<-df_performance%>%
filter(true_or_y_scrambled_labels_used ==1)%>%
group_by(dataset_readable, method, testset, descriptor)%>%summarise("median_balacc"=mean(balanced_accuracy))%>%mutate('mean'="Mean performance")
#Plotting function
plot_performance<-function(df_models, descriptor_oi){
g <- ggplot(data = df_models%>%filter(descriptor==descriptor_oi),aes(x=dataset_readable, y=balanced_accuracy )) +
geom_boxplot(data = df_models%>%filter(descriptor==descriptor_oi), aes(fill=method))+
geom_point(data=df_scrambledmedians%>%filter(descriptor==descriptor_oi),
aes(y=median_balacc,fill=method, shape=scrambled, group=method),
position=position_dodge(width=0.75), size=2)+
geom_point(data=df_standardmeans%>%filter(descriptor==descriptor_oi),
aes(y=median_balacc,fill=method,  shape=mean, group=method),
position=position_dodge(width=0.75), size=2)+
scale_shape_manual(values=c(23,24))+
scale_fill_brewer(palette='Set2')+
facet_wrap(~testset) + theme_bw()+
ylab("Balanced Accuracy")+
theme(text=element_text(size=13), axis.text.x=element_text(angle=60, hjust=1),legend.title = element_blank(), axis.title.x = element_blank())
return(g)
}
#Generate and save
gg_ECFP<-plot_performance(df_models, descriptor_oi = 'ECFP')
<<<<<<< HEAD
#Generate and save
gg_ECFP<-plot_performance(df_models, descriptor_oi = 'ECFP')
#Generate and save
gg_ECFP<-plot_performance(df_models, descriptor_oi = 'ECFP')
#<<<<<<< HEAD
ggsave(gg_ECFP,filename = '../plots/ECFP_performance.pdf', height = 95, width=170, units="mm")
ggsave(gg_ECFP,filename = '../plots/ECFP_performance.jpeg', height = 95, width=170, units="mm")
gg_MD<-plot_performance(df_models, descriptor_oi = 'MD')
ggsave(gg_MD,filename = '../plots/MD_performance.pdf', height = 95, width=170, units="mm")
ggsave(gg_MD,filename = '../plots/MD_performance.jpeg', height = 95, width=170, units="mm")
gg_PT<-plot_performance(df_models, descriptor_oi = 'PT')
ggsave(gg_PT,filename = '../plots/PT_performance.pdf', height = 95, width=170, units="mm")
ggsave(gg_PT,filename = '../plots/PT_performance.jpeg', height = 95, width=170, units="mm")
#=======
ggsave(gg_ECFP,filename = '../plots/ECFP_performance.pdf', height = 4.5, width=8)
ggsave(gg_ECFP,filename = '../plots/ECFP_performance.jpeg', height = 4.5, width=8)
gg_MD<-plot_performance(df_models, descriptor_oi = 'MD')
ggsave(gg_MD,filename = '../plots/MD_performance.pdf', height = 4.5, width=8)
ggsave(gg_MD,filename = '../plots/MD_performance.jpeg', height = 4.5, width=8)
gg_PT<-plot_performance(df_models, descriptor_oi = 'PT')
ggsave(gg_PT,filename = '../plots/PT_performance.pdf', height = 4.5, width=8)
ggsave(gg_PT,filename = '../plots/PT_performance.jpeg', height = 4.5, width=8)
